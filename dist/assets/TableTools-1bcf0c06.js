import{_ as T,o as t,d as _,t as k,f as s,c as p,h as l,w as f,F as h,v as E,i as b,$ as w,a0 as x,l as A,x as P,a1 as m,n as V,a2 as q,a3 as y,e as v,q as I,s as C}from"./index-88a5129e.js";import{_ as S,a as U}from"./visualizar-491b4619.js";import{_ as $,a as B}from"./ativo-27666d69.js";import{_ as z}from"./excluido-5dd3f69f.js";import{A as Q}from"./AppBar-f0429b7c.js";import{_ as N}from"./_plugin-vue_export-helper-c27b6911.js";import{V as R}from"./VRow-0c716acb.js";import"./VAutocomplete-6839ad36.js";import"./VSpacer-49a1f52c.js";import"./layout-44c14d18.js";const d=o=>(I("data-v-07e8376e"),o=o(),C(),o),D={key:1},L=d(()=>l("img",{class:"ml-8 mr-2",style:{width:"40px",height:"40px"},src:S,alt:"novo"},null,-1)),O=d(()=>l("h1",{style:{color:"#777777"}},"Predio Equipamentos",-1)),F={key:0,class:"custom-td"},M=["onClick"],H=d(()=>l("img",{style:{width:"40px",height:"40px"},src:U,alt:"Visualizar"},null,-1)),K=[H],j=["onClick"],G=d(()=>l("img",{style:{width:"40px",height:"40px"},src:B,alt:"Visualizar"},null,-1)),J=[G],W=["onClick"],X={key:0,src:z,alt:"Excluir",class:"trash-icon",style:{width:"40px",height:"40px"},title:"Reativar"},Y={key:1,src:$,alt:"Excluir",class:"trash-icon",style:{width:"40px",height:"40px"},title:"Excluir"},Z={components:{VDataTable:y},data(){return{userData:{},filteredPrediosEquipamentos:[],predios_equipamentos:[],loading:!0,searchQuery:"",itemsPerPage:[20],footerProps:[20],headers:[{title:"Codigo",value:"codigo",search:""},{title:"Patrimonio",value:"patrimonio",search:""},{title:"Descrição",value:"descricao",search:""},{title:"Ambiente",value:"ambiente",search:""},{title:"Modelo",value:"modelo",search:""},{title:"Ações",value:"actions",search:""}],emptyInputs:[{Codigo:"",patrimonio:"",descricao:"",ambiente:"",modelo:"",actions:""}]}},computed:{displayedItems(){return[...this.emptyInputs,...this.filteredPrediosEquipamentos]}},methods:{redirectToView(o){this.$router.push({name:"predios-equipamentos/index/vizualizar",query:{id:o}})},redirectToRegister(){this.$router.push({name:"predios-equipamentos/index/cadastro"})},redirectToUpdate(o){this.$router.push({name:"predios-equipamentos/index/atualizar",query:{id:o}})},async toggleExclusion(o){try{const e={Authorization:`Bearer ${this.userData.token}`};o.excluido=!o.excluido,await v.put(`http://localhost:3333/service/gerencia/PrediosEquipamentos/excluir/${o.id}`,{excluido:o.excluido},{headers:e}),console.log(o.excluido)}catch(e){console.error("Erro ao atualizar exclusão:",e),o.excluido=!o.excluido}},saveSearchQuery(){localStorage.setItem("searchQuery",this.searchQuery);const o=localStorage.getItem("searchQuery");console.log("saveSearchQuery:",o)},filterTable(){this.filteredPrediosEquipamentos=this.predios_equipamentos.filter(o=>this.headers.every(e=>{if(e.search.trim()==="")return!0;const i=String(o[e.value]).toLowerCase(),a=e.search.toLowerCase();return i.includes(a)}))},filterOnEnter(){console.log("Enter pressionado"),this.filterTable()},filterOnBlur(){console.log("Campo perdeu o foco"),this.filterTable()}},mounted(){this.userData=JSON.parse(localStorage.getItem("user"));const e={predio_token:JSON.parse(localStorage.getItem("predio")).predio_token},i={Authorization:`Bearer ${this.userData.token}`};v.post("http://localhost:3333/service/gerencia/listaEquipamentos",e,{headers:i}).then(r=>{this.predios_equipamentos=r.data[0].func_json_equipamentos,this.filteredPrediosEquipamentos=this.predios_equipamentos}).catch(r=>{console.error("Erro na chamada de API:",r)}).finally(()=>{this.loading=!1});const a=localStorage.getItem("searchQuery");console.log("Valor carregado do localStorage:",a),this.searchQuery=a||""}},ee=Object.assign(Z,{__name:"TableBuildTools",setup(o){return(e,i)=>{const a=T("b-tooltip");return e.loading?(t(),_(k,{key:0,class:"loading-spinner",indeterminate:"",size:"64"})):(t(),s("div",D,[p(Q),l("div",{class:"btn-pointer mt-8 mb-10",onClick:i[0]||(i[0]=r=>e.redirectToRegister())},[p(R,null,{default:f(()=>[L,O]),_:1})]),p(q(y),{headers:e.headers,search:e.searchQuery,items:e.displayedItems,"rows-per-page-items":e.itemsPerPage,"footer-props":e.footerProps,density:"default"},{item:f(({item:r,index:g})=>[l("tr",null,[(t(!0),s(h,null,E(e.headers,(u,n)=>(t(),s("td",{key:n},[g===0&&n!==e.headers.length-1?(t(),_(b,{key:0,modelValue:u.search,"onUpdate:modelValue":c=>u.search=c,outlined:"","hide-details":"",onKeydown:w(e.filterOnEnter,["enter"]),onBlur:e.filterOnBlur,ref_for:!0,ref:"searchFields",style:{width:"100%","background-color":"#ffffff",border:"1px solid #cccccc","border-radius":"5px"},class:x({focused:e.isFocused})},null,8,["modelValue","onUpdate:modelValue","onKeydown","onBlur","class"])):n!==e.headers.length-1?(t(),s(h,{key:1},[A(P(r[u.value]),1)],64)):(t(),s(h,{key:2},[g!==0&&n===e.headers.length-1?(t(),s("div",F,[m((t(),s("div",{class:"btn-pointer",onClick:c=>e.redirectToView(r.id),title:"Visualizar"},K,8,M)),[[a,void 0,void 0,{hover:!0}]]),m((t(),s("div",{class:"btn-pointer",onClick:c=>e.redirectToUpdate(r.id),title:"Editar"},J,8,j)),[[a,void 0,void 0,{hover:!0}]]),m((t(),s("div",{class:"btn-pointer",id:"exclusão",onClick:c=>e.toggleExclusion(r),title:"Excluir"},[r.excluido?(t(),s("img",X)):(t(),s("img",Y))],8,W)),[[a,void 0,void 0,{hover:!0}]])])):V("",!0)],64))]))),128))])]),_:1},8,["headers","search","items","rows-per-page-items","footer-props"])]))}}}),oe=N(ee,[["__scopeId","data-v-07e8376e"]]),pe={__name:"TableTools",setup(o){return(e,i)=>(t(),_(oe))}};export{pe as default};
