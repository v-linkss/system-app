import{o as r,d as m,t as y,f as i,c as h,w as _,h as a,F as p,v as b,i as A,$ as v,l as k,x as T,n as w,a2 as x,a3 as f,e as g,q as P,s as V}from"./index-00aeabf3.js";import{_ as I,a as E}from"./visualizar-491b4619.js";import{_ as S,a as C}from"./ativo-27666d69.js";import{_ as U}from"./excluido-5dd3f69f.js";import{A as $}from"./AppBar-b18ab963.js";import{_ as B}from"./_plugin-vue_export-helper-c27b6911.js";import{V as Q}from"./VRow-7de6535c.js";import"./VAutocomplete-6d9bbb06.js";import"./VSpacer-4c538066.js";import"./layout-8c213624.js";const d=t=>(P("data-v-14320a4e"),t=t(),V(),t),N={key:1},R=d(()=>a("img",{class:"ml-8 mr-2",style:{width:"40px",height:"40px"},src:I,alt:"novo"},null,-1)),z=[R],L=d(()=>a("h1",{class:"mt-8 mb-10",style:{color:"#777777"}},"Ambientes",-1)),D={key:0,class:"custom-td"},O=["onClick"],H=d(()=>a("img",{style:{width:"40px",height:"40px"},src:E,alt:"Visualizar"},null,-1)),F=[H],M=["onClick"],q=d(()=>a("img",{style:{width:"40px",height:"40px"},src:C,alt:"Visualizar"},null,-1)),K=[q],j=["onClick"],G={key:0,src:U,alt:"Excluir",class:"trash-icon",style:{width:"40px",height:"40px"},title:"Reativar"},J={key:1,src:S,alt:"Excluir",class:"trash-icon",style:{width:"40px",height:"40px"},title:"Excluir"},W={components:{VDataTable:f},data(){return{userData:{},filteredPrediosAmbientes:[],loading:!0,predios_ambientes:[],searchQuery:"",itemsPerPage:[20],footerProps:[20],emptyInputs:[{id:"",descricao:"",area:"",actions:""}],headers:[{title:"Código",value:"id",search:""},{title:"Descrição",value:"descricao",search:""},{title:"Area",value:"area",search:""},{title:"Ações",value:"actions",search:""}]}},computed:{displayedItems(){return[...this.emptyInputs,...this.filteredPrediosAmbientes]}},methods:{filterTable(){this.filteredPrediosAmbientes=this.predios_ambientes.filter(t=>this.headers.every(e=>{if(e.search.trim()==="")return!0;const o=String(t[e.value]).toLowerCase(),s=e.search.toLowerCase();return o.includes(s)})),console.log(this.filteredPrediosAmbientes)},filterOnEnter(){console.log("Enter pressionado"),this.filterTable()},filterOnBlur(){console.log("Campo perdeu o foco"),this.filterTable()},redirectToView(t){this.$router.push({name:"predios-ambientes/index/vizualizar",query:{id:t}})},redirectToRegister(){this.$router.push("/predios-ambientes/index/cadastro")},redirectToUpdate(t){this.$router.push({name:"predios-ambientes/index/alterar",query:{id:t}})},async toggleExclusion(t){const e={Authorization:`Bearer ${this.userData.token}`};try{t.excluido=!t.excluido,await g.put(`http://45.55.192.246:3333/service/gerencia/deleteAmbientes/${t.id}`,{excluido:t.excluido},{headers:e}),console.log(t.excluido)}catch(o){console.error("Erro ao atualizar exclusão:",o),t.excluido=!t.excluido}},saveSearchQuery(){localStorage.setItem("searchQuery",this.searchQuery);const t=localStorage.getItem("searchQuery");console.log("saveSearchQuery:",t)}},mounted(){this.userData=JSON.parse(localStorage.getItem("user"));const t={Authorization:`Bearer ${this.userData.token}`},o={predio_token:JSON.parse(localStorage.getItem("predio")).predio_token};g.post("http://45.55.192.246:3333/service/gerencia/listaAmbientes",o,{headers:t}).then(l=>{this.predios_ambientes=l.data[0].func_json_ambientes,this.filteredPrediosAmbientes=this.predios_ambientes,console.log(this.filteredPrediosAmbientes)}).catch(l=>{console.error("Erro na chamada de API:",l)}).finally(()=>{this.loading=!1});const s=localStorage.getItem("searchQuery");console.log("Valor carregado do localStorage:",s),this.searchQuery=s||""}},X=Object.assign(W,{__name:"TableAmbientes",setup(t){return(e,o)=>e.loading?(r(),m(y,{key:0,class:"loading-spinner",indeterminate:"",size:"64"})):(r(),i("div",N,[h($),h(Q,null,{default:_(()=>[a("div",{class:"btn-pointer mt-8 mb-10",onClick:o[0]||(o[0]=s=>e.redirectToRegister())},z),L]),_:1}),h(x(f),{headers:e.headers,search:e.searchQuery,items:e.displayedItems,"rows-per-page-items":e.itemsPerPage,"footer-props":e.footerProps,density:"default"},{item:_(({item:s,index:l})=>[a("tr",null,[(r(!0),i(p,null,b(e.headers,(u,n)=>(r(),i("td",{key:n},[l===0&&n!==e.headers.length-1?(r(),m(A,{key:0,modelValue:u.search,"onUpdate:modelValue":c=>u.search=c,outlined:"","hide-details":"",onKeydown:v(e.filterOnEnter,["enter"]),onBlur:e.filterOnBlur,ref_for:!0,ref:"searchFields",style:{width:"100%","background-color":"#ffffff",border:"1px solid #cccccc","border-radius":"5px"}},null,8,["modelValue","onUpdate:modelValue","onKeydown","onBlur"])):n!==e.headers.length-1?(r(),i(p,{key:1},[k(T(s[u.value]),1)],64)):(r(),i(p,{key:2},[l!==0&&n===e.headers.length-1?(r(),i("div",D,[a("div",{class:"btn-pointer",onClick:c=>e.redirectToView(s.id),title:"Visualizar"},F,8,O),a("div",{class:"btn-pointer",onClick:c=>e.redirectToUpdate(s.id),title:"Editar"},K,8,M),a("div",{class:"btn-pointer",id:"exclusão",onClick:c=>e.toggleExclusion(s)},[s.excluido?(r(),i("img",G)):(r(),i("img",J))],8,j)])):w("",!0)],64))]))),128))])]),_:1},8,["headers","search","items","rows-per-page-items","footer-props"])]))}}),Y=B(X,[["__scopeId","data-v-14320a4e"]]),ce={__name:"AmbientesHome",setup(t){return(e,o)=>(r(),m(Y))}};export{ce as default};
