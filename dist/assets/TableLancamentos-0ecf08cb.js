import{_ as T,o as s,d as y,t as w,f as a,c as h,h as l,w as v,F as p,v as x,i as A,$ as L,x as _,n as m,l as V,a1 as g,a2 as E,a3 as k,e as b,q as I,s as S}from"./index-88a5129e.js";import{_ as C,a as P}from"./visualizar-491b4619.js";import{_ as U,a as $}from"./ativo-27666d69.js";import{_ as B}from"./excluido-5dd3f69f.js";import{A as Q}from"./AppBar-f0429b7c.js";import{_ as z}from"./_plugin-vue_export-helper-c27b6911.js";import{V as N}from"./VRow-0c716acb.js";import"./VAutocomplete-6839ad36.js";import"./VSpacer-49a1f52c.js";import"./layout-44c14d18.js";const u=t=>(I("data-v-2bad82b5"),t=t(),S(),t),R={key:1},D=u(()=>l("img",{class:"ml-8 mr-2",style:{width:"40px",height:"40px"},src:C,alt:"novo"},null,-1)),q=u(()=>l("h1",{style:{color:"#777777"}},"Lancamentos",-1)),O={key:0},F={key:1},H={key:0,class:"custom-td"},M=["onClick"],K=u(()=>l("img",{style:{width:"40px",height:"40px"},src:P,alt:"Visualizar"},null,-1)),G=[K],J=["onClick"],j=u(()=>l("img",{style:{width:"40px",height:"40px"},src:$,alt:"Visualizar"},null,-1)),W=[j],X=["onClick"],Y={key:0,src:B,alt:"Excluir",class:"trash-icon",style:{width:"40px",height:"40px"},title:"Reativar"},Z={key:1,src:U,alt:"Excluir",class:"trash-icon",style:{width:"40px",height:"40px"},title:"Excluir"},ee={components:{VDataTable:k},data(){return{filteredLancamentos:[],loading:!0,lancamentos:[],searchQuery:"",itemsPerPage:[20],footerProps:[20],emptyInputs:[{id:"",descricao:"",area:"",actions:""}],headers:[{title:"Data",value:"data",search:""},{title:"Conta",search:""},{title:"Equipamento",search:""},{title:"Descrição",value:"descricao",search:""},{title:"Ações",value:"actions",search:""}]}},computed:{displayedItems(){return[...this.emptyInputs,...this.filteredLancamentos]}},methods:{filterTable(){this.filteredLancamentos=this.lancamentos.filter(t=>this.headers.every(e=>{if(e.search.trim()==="")return!0;const r=String(t[e.value]).toLowerCase(),i=e.search.toLowerCase();return r.includes(i)}))},filterOnEnter(){this.filterTable()},filterOnBlur(){this.filterTable()},redirectToView(t){this.$router.push({name:"pi-lancamentos/index/vizualizar",query:{id:t}})},redirectToRegister(){this.$router.push("/pi-lancamentos/index/cadastro")},redirectToUpdate(t){this.$router.push({name:"pi-lancamentos/index/atualizar",query:{id:t}})},async toggleExclusion(t){try{const e={Authorization:`Bearer ${this.userData.token}`};return t.excluido=!t.excluido,await b.put(`http://localhost:3333/service/gerencia/updateLancamentos/${t.id}`,{excluido:t.excluido},{headers:e})}catch(e){console.error("Erro ao atualizar exclusão:",e),t.excluido=!t.excluido}},saveSearchQuery(){localStorage.setItem("searchQuery",this.searchQuery);const t=localStorage.getItem("searchQuery");console.log("saveSearchQuery:",t)}},mounted(){this.userData=JSON.parse(localStorage.getItem("user"));const t={Authorization:`Bearer ${this.userData.token}`},r={predio_id:JSON.parse(localStorage.getItem("predio")).predio_id};b.post("http://localhost:3333/service/gerencia/tabLancamentos",r,{headers:t}).then(o=>{this.lancamentos=o.data.lancamentos,this.filteredLancamentos=this.lancamentos,console.log(o.data)}).catch(o=>{console.error("Erro na chamada de API:",o)}).finally(()=>{this.loading=!1});const i=localStorage.getItem("searchQuery");console.log("Valor carregado do localStorage:",i),this.searchQuery=i||""}},te=Object.assign(ee,{__name:"TableLancamentos",setup(t){return(e,r)=>{const i=T("b-tooltip");return e.loading?(s(),y(w,{key:0,class:"loading-spinner",indeterminate:"",size:"64"})):(s(),a("div",R,[h(Q),l("div",{class:"btn-pointer mt-8 mb-10",onClick:r[0]||(r[0]=o=>e.redirectToRegister())},[h(N,null,{default:v(()=>[D,q]),_:1})]),h(E(k),{headers:e.headers,search:e.searchQuery,items:e.displayedItems,"rows-per-page-items":e.itemsPerPage,"footer-props":e.footerProps,density:"default"},{item:v(({item:o,index:f})=>[l("tr",null,[(s(!0),a(p,null,x(e.headers,(n,c)=>(s(),a("td",{key:c},[f===0&&c!==e.headers.length-1?(s(),y(A,{key:0,modelValue:n.search,"onUpdate:modelValue":d=>n.search=d,outlined:"","hide-details":"",onKeydown:L(e.filterOnEnter,["enter"]),onBlur:e.filterOnBlur,ref_for:!0,ref:"searchFields",style:{width:"100%","background-color":"#ffffff",border:"1px solid #cccccc","border-radius":"5px"}},null,8,["modelValue","onUpdate:modelValue","onKeydown","onBlur"])):c!==e.headers.length-1?(s(),a(p,{key:1},[n.title==="Conta"?(s(),a("td",O,_(o.pi_contas.descricao),1)):m("",!0),n.title==="Equipamento"?(s(),a("td",F,_(o.predios_equipamentos?o.predios_equipamentos.descricao:""),1)):m("",!0),V(" "+_(o[n.value]),1)],64)):(s(),a(p,{key:2},[f!==0&&c===e.headers.length-1?(s(),a("div",H,[g((s(),a("div",{class:"btn-pointer",onClick:d=>e.redirectToView(o.id),title:"Visualizar"},G,8,M)),[[i,void 0,void 0,{hover:!0}]]),g((s(),a("div",{class:"btn-pointer",onClick:d=>e.redirectToUpdate(o.id),title:"Editar"},W,8,J)),[[i,void 0,void 0,{hover:!0}]]),g((s(),a("div",{class:"btn-pointer",id:"exclusão",onClick:d=>e.toggleExclusion(o),title:"Excluir"},[o.excluido?(s(),a("img",Y)):(s(),a("img",Z))],8,X)),[[i,void 0,void 0,{hover:!0}]])])):m("",!0)],64))]))),128))])]),_:1},8,["headers","search","items","rows-per-page-items","footer-props"])]))}}}),se=z(te,[["__scopeId","data-v-2bad82b5"]]),pe={__name:"TableLancamentos",setup(t){return(e,r)=>(s(),y(se))}};export{pe as default};
