import{A as L}from"./AppBar-f0429b7c.js";import{u as c}from"./vee-validate.esm-9e73a9b7.js";import{_ as T,o as f,f as I,c as t,w as l,i as h,a2 as _,a1 as E,j as g,l as u,k as y,d as v,n as q,F as R,e as p,q as N,s as w,h as P}from"./index-88a5129e.js";import{_ as S}from"./_plugin-vue_export-helper-c27b6911.js";import{V as m}from"./VAutocomplete-6839ad36.js";import{V as b}from"./VRow-0c716acb.js";import{V as M}from"./VDialog-b3b4de36.js";import{V as $,c as C,d as D}from"./VCard-2409a6d1.js";import{V as B}from"./VSpacer-49a1f52c.js";import{V as O}from"./VContainer-2697f82e.js";import"./layout-44c14d18.js";const H=r=>(N("data-v-e27b2e37"),r=r(),w(),r),z=H(()=>P("h1",{class:"ml-5 mt-5 mb-5",style:{color:"#777777"}},"Receita dos Lotes",-1)),J={data(){return{userData:{},pi_lotes_receitas:{data:void 0,lote_id:void 0,conta_id:void 0,valor:void 0,predio_equipamento_id:void 0,cobrar:void 0,observacao:void 0},lotes:[],contas:[],showError:!1,equipamentos:[],cobranca:[{id:!0,descricao:"COBRAR"},{id:!1,descricao:"DEVOLVER"}]}},methods:{returnToTableLotes(){this.$router.push("/pi-lotes-receitas/index/")},async loadLotesDetails(){try{const r={Authorization:`Bearer ${this.userData.token}`},o=await p.get(`http://localhost:3333/service/gerencia/ReceitaLotes/${this.pi_lotes_receitas.id}`,{headers:r});this.pi_lotes_receitas.cobrar=o.data.cobrar,this.pi_lotes_receitas.conta_id=o.data.conta_id,this.pi_lotes_receitas.predio_equipamento_id=o.data.predio_equipamento_id,this.pi_lotes_receitas.data=o.data.data,this.pi_lotes_receitas.valor=o.data.valor,this.pi_lotes_receitas.observacao=o.data.observacao,this.pi_lotes_receitas.lote_id=o.data.lote_id}catch(r){console.error("Erro ao carregar detalhes do prédio_equipamentos:",r)}},async loadEquipamentos(){const o={predio_token:JSON.parse(localStorage.getItem("predio")).predio_token};try{const s={Authorization:`Bearer ${this.userData.token}`},d=(await p.post("http://localhost:3333/service/gerencia/loteEquipamentos",o,{headers:s})).data[0].func_json_equipamentos_combolist;this.equipamentos=d}catch(s){console.error("Erro ao carregar tipos:",s)}},async loadContas(){const o={predio_token:JSON.parse(localStorage.getItem("predio")).predio_token};try{const s={Authorization:`Bearer ${this.userData.token}`},d=(await p.post("http://localhost:3333/service/gerencia/contasPredios",o,{headers:s})).data[0].func_json_contas_predio;this.contas=d,console.log(this.contas)}catch(s){console.error("Erro ao carregar áreas:",s)}},async loadLotes(){const o={predio_token:JSON.parse(localStorage.getItem("predio")).predio_token};try{const s={Authorization:`Bearer ${this.userData.token}`},d=(await p.post("http://localhost:3333/service/gerencia/lotesPredios",o,{headers:s})).data[0].func_json_lotes_predio;this.lotes=d,console.log(this.lotes)}catch(s){console.error("Erro ao carregar áreas:",s)}},async submit(){this.pi_lotes_receitas.conta_id===void 0&&(this.pi_lotes_receitas.conta_id=null),this.pi_lotes_receitas.lote_id===void 0&&(this.pi_lotes_receitas.lote_id=null),this.pi_lotes_receitas.predio_equipamento_id===void 0&&(this.pi_lotes_receitas.predio_equipamento_id=null),this.pi_lotes_receitas.cobrar===void 0&&(this.pi_lotes_receitas.cobrar=null);const r=JSON.parse(localStorage.getItem("predio")),o=JSON.parse(localStorage.getItem("user")),s={cobrar:this.pi_lotes_receitas.cobrar,conta_id:this.pi_lotes_receitas.conta_id,predio_equipamento_id:this.pi_lotes_receitas.predio_equipamento_id,data:this.pi_lotes_receitas.data,valor:this.pi_lotes_receitas.valor,observacao:this.pi_lotes_receitas.observacao,lote_id:this.pi_lotes_receitas.lote_id,predio_id:r.predio_id,user_created:o.id};try{const n={Authorization:`Bearer ${this.userData.token}`},d=await p.put(`http://localhost:3333/service/gerencia/updateReceitaLotes/${this.pi_lotes_receitas.id}`,s,{headers:n});return this.$router.push("/pi-lotes-receitas/index/"),d}catch(n){console.error("Erro na criação do registro:",n),this.showError=!0}}},created(){this.$route.query.id?this.pi_lotes_receitas.id=this.$route.query.id:console.log("Erro em carregar dados")},mounted(){this.userData=JSON.parse(localStorage.getItem("user")),this.loadContas(),this.loadEquipamentos(),this.loadLotes(),this.loadLotesDetails()}},j=Object.assign(J,{__name:"UpdateLotes",setup(r){const o=c("data"),s=c("predio_equipamento_id"),n=c("cobrar"),d=c("lote_id"),A=c("observacao"),V=c("valor"),U=c("conta_id");return(e,i)=>{const k=T("mask");return f(),I(R,null,[t(L),t(O,null,{default:l(()=>[z,t(h,{style:{width:"300px"},class:"ml-5 mr-5",modelValue:e.pi_lotes_receitas.data,"onUpdate:modelValue":i[0]||(i[0]=a=>e.pi_lotes_receitas.data=a),"error-messages":_(o).errorMessage.value,type:"date",label:"Data(*)",autofocus:""},null,8,["modelValue","error-messages"]),t(m,{style:{width:"700px"},class:"ml-5 mr-5",modelValue:e.pi_lotes_receitas.lote_id,"onUpdate:modelValue":i[1]||(i[1]=a=>e.pi_lotes_receitas.lote_id=a),items:e.lotes,label:"Selecione um lote(*)","item-title":"nome","item-value":"id","error-messages":_(d).errorMessage.value,clearable:""},null,8,["modelValue","items","error-messages"]),t(b,{"no-gutters":""},{default:l(()=>[t(m,{style:{width:"10px"},class:"ml-5 mr-5 mt-5",density:"compact",modelValue:e.pi_lotes_receitas.conta_id,"onUpdate:modelValue":i[2]||(i[2]=a=>e.pi_lotes_receitas.conta_id=a),items:e.contas,label:"Selecione uma Conta","item-title":"descricao","item-value":"id","error-messages":_(U).errorMessage.value,clearable:""},null,8,["modelValue","items","error-messages"]),E(t(h,{class:"ml-5 mr-5 mt-5",modelValue:e.pi_lotes_receitas.valor,"onUpdate:modelValue":i[3]||(i[3]=a=>e.pi_lotes_receitas.valor=a),modelModifiers:{number:!0},"error-messages":_(V).errorMessage.value,label:"Valor(*)"},null,8,["modelValue","error-messages"]),[[k,"#####.##"]])]),_:1}),t(b,{"no-gutters":""},{default:l(()=>[t(m,{style:{width:"90px"},class:"ml-5 mr-5 mt-1",modelValue:e.pi_lotes_receitas.predio_equipamento_id,"onUpdate:modelValue":i[4]||(i[4]=a=>e.pi_lotes_receitas.predio_equipamento_id=a),items:e.equipamentos,"item-title":"descricao","item-value":"id","error-messages":_(s).errorMessage.value,label:"Selecione um Equipamento",clearable:""},null,8,["modelValue","items","error-messages"]),t(m,{class:"ml-5 mr-5 mt-1",modelValue:e.pi_lotes_receitas.cobrar,"onUpdate:modelValue":i[5]||(i[5]=a=>e.pi_lotes_receitas.cobrar=a),items:e.cobranca,"item-title":"descricao","item-value":"id","error-messages":_(n).errorMessage.value,label:"Cobrar(*)",clearable:""},null,8,["modelValue","items","error-messages"])]),_:1}),t(h,{class:"ml-5 mr-5 mt-5",style:{height:"100px"},modelValue:e.pi_lotes_receitas.observacao,"onUpdate:modelValue":i[6]||(i[6]=a=>e.pi_lotes_receitas.observacao=a),"error-messages":_(A).errorMessage.value,label:"Observação"},null,8,["modelValue","error-messages"]),t(g,{class:"ml-5 me-4 mt-4",color:"red",onClick:e.returnToTableLotes},{default:l(()=>[u(" Voltar ")]),_:1},8,["onClick"]),t(M,{"max-width":"500"},{activator:l(({props:a})=>[t(g,y({class:"me-4 mt-8"},a,{color:"green",onClick:e.submit}),{default:l(()=>[u(" Atualizar ")]),_:2},1040,["onClick"])]),default:l(({isActive:a})=>[e.showError?(f(),v($,{key:0},{default:l(()=>[t(C,null,{default:l(()=>[u(" Ocorreu erro ao atualizar o campo. ")]),_:1}),t(D,null,{default:l(()=>[t(B),t(g,{style:{"background-color":"#1b5175",color:"white"},onClick:F=>a.value=!1},{default:l(()=>[u("OK")]),_:2},1032,["onClick"])]),_:2},1024)]),_:2},1024)):q("",!0)]),_:1})]),_:1})],64)}}}),G=S(j,[["__scopeId","data-v-e27b2e37"]]),se={__name:"LotesUpdate",setup(r){return(o,s)=>(f(),v(G))}};export{se as default};
