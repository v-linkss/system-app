import{_ as T,o as s,d as _,t as k,f as o,c as p,h as l,w as y,F as h,v as E,i as b,$ as w,a0 as x,l as A,x as V,a1 as m,n as q,a2 as P,a3 as v,e as f,q as I,s as S}from"./index-bf573807.js";import{_ as C,a as U}from"./visualizar-491b4619.js";import{_ as $,a as z}from"./ativo-27666d69.js";import{_ as B}from"./excluido-5dd3f69f.js";import{A as Q}from"./AppBar-caeecede.js";import{_ as N}from"./_plugin-vue_export-helper-c27b6911.js";import{V as R}from"./VRow-835fc559.js";import"./VAutocomplete-22e1fd5b.js";import"./VSpacer-441d260f.js";import"./layout-c76e1f01.js";const d=t=>(I("data-v-e14cb660"),t=t(),S(),t),D={key:1},L=d(()=>l("img",{class:"ml-8 mr-2",style:{width:"40px",height:"40px"},src:C,alt:"novo"},null,-1)),O=d(()=>l("h1",{style:{color:"#777777"}},"Tipos Equipamentos",-1)),F={key:0,class:"custom-td"},H=["onClick"],M=d(()=>l("img",{style:{width:"40px",height:"40px"},src:U,alt:"Visualizar"},null,-1)),K=[M],j=["onClick"],G=d(()=>l("img",{style:{width:"40px",height:"40px"},src:z,alt:"Visualizar"},null,-1)),J=[G],W=["onClick"],X={key:0,src:B,alt:"Excluir",class:"trash-icon",style:{width:"40px",height:"40px"},title:"Reativar"},Y={key:1,src:$,alt:"Excluir",class:"trash-icon",style:{width:"40px",height:"40px"},title:"Excluir"},Z={components:{VDataTable:v},data(){return{userData:{},filteredPrediosEquipamentos:[],tipos_equipamentos:[],segmentos:[],loading:!0,searchQuery:"",itemsPerPage:[20],footerProps:[20],headers:[{title:"Codigo",value:"id",search:""},{title:"Descrição",value:"descricao",search:""},{title:"Sistema",value:"sistema",search:""},{title:"Segmento",value:"segmento",search:""},{title:"Ações",value:"actions",search:""}],emptyInputs:[{id:"",descricao:"",sistema:"",segmento:"",actions:""}]}},computed:{displayedItems(){return[...this.emptyInputs,...this.filteredPrediosEquipamentos]}},methods:{redirectToView(t){this.$router.push({name:"equipamentos-tipos/index/vizualizar",query:{id:t}})},redirectToRegister(){this.$router.push("/equipamentos-tipos/index/cadastro")},redirectToUpdate(t){this.$router.push({name:"equipamentos-tipos/index/atualizar",query:{id:t}})},async toggleExclusion(t){try{const e={Authorization:`Bearer ${this.userData.token}`};t.excluido=!t.excluido,await f.put(`http://45.55.192.246:3333/service/gerencia/updateEquipamentos/${t.id}`,{excluido:t.excluido},{headers:e}),console.log(t.excluido)}catch(e){console.error("Erro ao atualizar exclusão:",e),t.excluido=!t.excluido}},saveSearchQuery(){localStorage.setItem("searchQuery",this.searchQuery);const t=localStorage.getItem("searchQuery");console.log("saveSearchQuery:",t)},filterTable(){this.filteredPrediosEquipamentos=this.tipos_equipamentos.filter(t=>this.headers.every(e=>{if(e.search.trim()==="")return!0;const i=String(t[e.value]).toLowerCase(),a=e.search.toLowerCase();return i.includes(a)}))},filterOnEnter(){console.log("Enter pressionado"),this.filterTable()},filterOnBlur(){console.log("Campo perdeu o foco"),this.filterTable()}},mounted(){this.userData=JSON.parse(localStorage.getItem("user"));const e={token_predio:JSON.parse(localStorage.getItem("predio")).predio_token},i={Authorization:`Bearer ${this.userData.token}`};f.post("http://45.55.192.246:3333/service/gerencia/listaTiposEquipamentos",e,{headers:i}).then(r=>{this.tipos_equipamentos=r.data[0].func_json_tiposequipamentos,this.filteredPrediosEquipamentos=this.tipos_equipamentos}).catch(r=>{console.error("Erro na chamada de API:",r)}).finally(()=>{this.loading=!1});const a=localStorage.getItem("searchQuery");console.log("Valor carregado do localStorage:",a),this.searchQuery=a||""}},ee=Object.assign(Z,{__name:"TableTypesTools",setup(t){return(e,i)=>{const a=T("b-tooltip");return e.loading?(s(),_(k,{key:0,class:"loading-spinner",indeterminate:"",size:"64"})):(s(),o("div",D,[p(Q),l("div",{class:"btn-pointer mt-8 mb-10",onClick:i[0]||(i[0]=r=>e.redirectToRegister())},[p(R,null,{default:y(()=>[L,O]),_:1})]),p(P(v),{headers:e.headers,search:e.searchQuery,items:e.displayedItems,"rows-per-page-items":e.itemsPerPage,"footer-props":e.footerProps,density:"default"},{item:y(({item:r,index:g})=>[l("tr",null,[(s(!0),o(h,null,E(e.headers,(u,n)=>(s(),o("td",{key:n},[g===0&&n!==e.headers.length-1?(s(),_(b,{key:0,modelValue:u.search,"onUpdate:modelValue":c=>u.search=c,outlined:"","hide-details":"",onKeydown:w(e.filterOnEnter,["enter"]),onBlur:e.filterOnBlur,ref_for:!0,ref:"searchFields",style:{width:"100%","background-color":"#ffffff",border:"1px solid #cccccc","border-radius":"5px"},class:x({focused:e.isFocused})},null,8,["modelValue","onUpdate:modelValue","onKeydown","onBlur","class"])):n!==e.headers.length-1?(s(),o(h,{key:1},[A(V(r[u.value]),1)],64)):(s(),o(h,{key:2},[g!==0&&n===e.headers.length-1?(s(),o("div",F,[m((s(),o("div",{class:"btn-pointer",onClick:c=>e.redirectToView(r.id),title:"Visualizar"},K,8,H)),[[a,void 0,void 0,{hover:!0}]]),m((s(),o("div",{class:"btn-pointer",onClick:c=>e.redirectToUpdate(r.id),title:"Editar"},J,8,j)),[[a,void 0,void 0,{hover:!0}]]),m((s(),o("div",{class:"btn-pointer",id:"exclusão",onClick:c=>e.toggleExclusion(r),title:"Excluir"},[r.excluido?(s(),o("img",X)):(s(),o("img",Y))],8,W)),[[a,void 0,void 0,{hover:!0}]])])):q("",!0)],64))]))),128))])]),_:1},8,["headers","search","items","rows-per-page-items","footer-props"])]))}}}),te=N(ee,[["__scopeId","data-v-e14cb660"]]),pe={__name:"TableTypesTools",setup(t){return(e,i)=>(s(),_(te))}};export{pe as default};
