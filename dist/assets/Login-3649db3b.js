import{e as w,o as n,f as V,h as p,c as a,V as v,i as g,w as t,j as d,k,l as c,d as u,n as m,q as b,s as y}from"./index-bf573807.js";import{_ as C}from"./Logo-abaa2168.js";import{_ as A}from"./_plugin-vue_export-helper-c27b6911.js";import{V as h}from"./VCard-8ca74176.js";import{V as _}from"./VSpacer-441d260f.js";import{V as I}from"./VDialog-7687c8ff.js";const U={data:()=>({visible:!1,email:"",senha:"",dialog:!1,showError:!1,showEmailError:!1,showPasswordError:!1}),methods:{async login(){const e={email:this.email,senha:this.senha};try{const s=await w.post("http://45.55.192.246:3333/login",e);if(s.status===200){const o=s.data;if(o[0].func_autentica_acesso_v1[0]&&o[0].func_autentica_acesso_v1[0].status==="OK"&&o[0].func_autentica_acesso_v1[0].registro&&o[0].func_autentica_acesso_v1[0].registro.length>0){const i=o[0].func_autentica_acesso_v1[0].registro[0];i.predios&&i.predios.length>1?(this.$store.dispatch("setUser",i),this.$store.dispatch("setCombo",i.predios),this.$router.push({name:"selecao-predio"})):(this.$store.commit("setUser",i),this.$store.commit("setPredio",i.predios[0]),this.$store.dispatch("listarEquipamento"),this.$store.dispatch("listarMenu"),this.$router.push("/panel/index"))}else console.error("Erro de autenticação com usuário"),console.log(o),this.showError=!0}}catch(s){if(console.error("Erro ao fazer login",s),s.response&&s.response.status===400){const o=s.response.data[0].func_autentica_acesso_v1[0];console.log(o),o.status_mensagem==="Esse email não está cadastrado."?this.showEmailError=!0:o.status_mensagem==="Senha inválida."?this.showPasswordError=!0:o.error==="Erro ao autenticar usuário"&&(this.showError=!0)}}},closeAlert(){this.showError=!1,this.showEmailError=!1,this.showPasswordError=!1,this.dialog=!1}}},f=e=>(b("data-v-d04a663e"),e=e(),y(),e),$={class:"container1"},P={class:"container"},L=f(()=>p("div",{class:"text"},"Log in",-1)),S=f(()=>p("a",{class:"text-decoration-none",href:"/esqueci-senha",rel:"noopener noreferrer",style:{color:"#1b5175"}}," Esqueceu a senha?",-1)),N=f(()=>p("div",{class:"background-image"},null,-1));function B(e,s,o,i,q,l){return n(),V("div",$,[p("div",P,[a(v,{class:"image",width:300,height:"230",src:C}),L,a(g,{autofocus:"",modelValue:e.email,"onUpdate:modelValue":s[0]||(s[0]=r=>e.email=r),"persistent-hint":"",class:"input",density:"compact",placeholder:"Email","prepend-inner-icon":"mdi-email-outline",variant:"outlined"},null,8,["modelValue"]),a(g,{modelValue:e.senha,"onUpdate:modelValue":s[1]||(s[1]=r=>e.senha=r),class:"input","append-inner-icon":e.visible?"mdi-eye-off":"mdi-eye",type:e.visible?"text":"password",density:"compact",placeholder:"Senha","prepend-inner-icon":"mdi-lock-outline",variant:"outlined","onClick:appendInner":s[2]||(s[2]=r=>e.visible=!e.visible)},null,8,["modelValue","append-inner-icon","type"]),a(I,{modelValue:e.dialog,"onUpdate:modelValue":s[4]||(s[4]=r=>e.dialog=r),"max-width":"400",persistent:""},{activator:t(({props:r})=>[a(d,k({block:"",rounded:"",class:"button mb-10 mt-4"},r,{onClick:l.login,modelValue:e.dialog,"onUpdate:modelValue":s[3]||(s[3]=E=>e.dialog=E)}),{default:t(()=>[c(" Acessar ")]),_:2},1040,["onClick","modelValue"])]),default:t(()=>[e.showPasswordError?(n(),u(h,{key:0,text:"Senha inválida."},{actions:t(()=>[a(_),a(d,{onClick:l.closeAlert,style:{"background-color":"#1b5175",color:"white"}},{default:t(()=>[c(" OK ")]),_:1},8,["onClick"])]),_:1})):m("",!0),e.showEmailError?(n(),u(h,{key:1,text:"Esse email não está cadastrado."},{actions:t(()=>[a(_),a(d,{onClick:l.closeAlert,style:{"background-color":"#1b5175",color:"white"}},{default:t(()=>[c(" OK ")]),_:1},8,["onClick"])]),_:1})):m("",!0),e.showError?(n(),u(h,{key:2,text:"Erro no sistema"},{actions:t(()=>[a(_),a(d,{onClick:l.closeAlert,style:{"background-color":"#1b5175",color:"white"}},{default:t(()=>[c(" OK ")]),_:1},8,["onClick"])]),_:1})):m("",!0)]),_:1},8,["modelValue"]),S]),N])}const T=A(U,[["render",B],["__scopeId","data-v-d04a663e"]]),H={__name:"Login",setup(e){return(s,o)=>(n(),u(T))}};export{H as default};
