import{_ as k,o as t,d as _,t as E,f as s,c as p,h as l,w as f,F as h,v as T,i as b,$ as w,a0 as q,l as x,x as A,a1 as m,n as V,a2 as P,a3 as y,e as v,q as I,s as C}from"./index-88a5129e.js";import{_ as S,a as U}from"./visualizar-491b4619.js";import{_ as $,a as z}from"./ativo-27666d69.js";import{_ as B}from"./excluido-5dd3f69f.js";import{A as M}from"./AppBar-f0429b7c.js";import{_ as Q}from"./_plugin-vue_export-helper-c27b6911.js";import{V as N}from"./VRow-0c716acb.js";import"./VAutocomplete-6839ad36.js";import"./VSpacer-49a1f52c.js";import"./layout-44c14d18.js";const d=o=>(I("data-v-5087447d"),o=o(),C(),o),R={key:1},D=d(()=>l("img",{class:"ml-8 mr-2",style:{width:"40px",height:"40px"},src:S,alt:"novo"},null,-1)),L=d(()=>l("h1",{style:{color:"#777777"}},"Modelos Equipamentos",-1)),O={key:0,class:"custom-td"},F=["onClick"],H=d(()=>l("img",{style:{width:"40px",height:"40px"},src:U,alt:"Visualizar"},null,-1)),K=[H],j=["onClick"],G=d(()=>l("img",{style:{width:"40px",height:"40px"},src:z,alt:"Visualizar"},null,-1)),J=[G],W=["onClick"],X={key:0,src:B,alt:"Excluir",class:"trash-icon",style:{width:"40px",height:"40px"},title:"Reativar"},Y={key:1,src:$,alt:"Excluir",class:"trash-icon",style:{width:"40px",height:"40px"},title:"Excluir"},Z={components:{VDataTable:y},data(){return{userData:{},filteredPrediosEquipamentos:[],equipamentos_modelos:[],loading:!0,searchQuery:"",itemsPerPage:[20],footerProps:[20],emptyInputs:[{id:"",descricao:"",tipo:"",fabricante:"",actions:""}],headers:[{title:"Codigo",value:"id",search:""},{title:"Descrição",value:"descricao",search:""},{title:"Tipo",value:"tipo",search:""},{title:"Fabricante",value:"fabricante",search:""},{title:"Ações",value:"actions",search:""}]}},computed:{displayedItems(){return[...this.emptyInputs,...this.filteredPrediosEquipamentos]}},methods:{redirectToView(o){this.$router.push({name:"equipamentos-modelos/index/vizualizar",query:{id:o}})},redirectToRegister(){this.$router.push({name:"equipamentos-modelos/index/cadastro"})},redirectToUpdate(o){this.$router.push({name:"equipamentos-modelos/index/atualizar",query:{id:o}})},async toggleExclusion(o){try{o.excluido=!o.excluido;const e={Authorization:`Bearer ${this.userData.token}`};await v.put(` http://localhost:3333/service/gerencia/deleteModeloEquipamentos/${o.id}`,{excluido:o.excluido},{headers:e}),console.log(o.excluido)}catch(e){console.error("Erro ao atualizar exclusão:",e),o.excluido=!o.excluido}},saveSearchQuery(){localStorage.setItem("searchQuery",this.searchQuery);const o=localStorage.getItem("searchQuery");console.log("saveSearchQuery:",o)},filterTable(){this.filteredPrediosEquipamentos=this.equipamentos_modelos.filter(o=>this.headers.every(e=>{if(e.search.trim()==="")return!0;const i=String(o[e.value]).toLowerCase(),a=e.search.toLowerCase();return i.includes(a)}))},filterOnEnter(){console.log("Enter pressionado"),this.filterTable()},filterOnBlur(){console.log("Campo perdeu o foco"),this.filterTable()}},mounted(){this.userData=JSON.parse(localStorage.getItem("user"));const e={token_predio:JSON.parse(localStorage.getItem("predio")).predio_token},i={Authorization:`Bearer ${this.userData.token}`};v.post("http://localhost:3333/service/gerencia/listaModeloEquipamentos",e,{headers:i}).then(r=>{this.equipamentos_modelos=r.data[0].func_json_modelos_equipamentos,this.filteredPrediosEquipamentos=this.equipamentos_modelos}).catch(r=>{console.error("Erro na chamada de API:",r)}).finally(()=>{this.loading=!1});const a=localStorage.getItem("searchQuery");console.log("Valor carregado do localStorage:",a),this.searchQuery=a||""}},ee=Object.assign(Z,{__name:"TableEquipamentoModelo",setup(o){return(e,i)=>{const a=k("b-tooltip");return e.loading?(t(),_(E,{key:0,class:"loading-spinner",indeterminate:"",size:"64"})):(t(),s("div",R,[p(M),l("div",{class:"btn-pointer mt-8 mb-10",onClick:i[0]||(i[0]=r=>e.redirectToRegister())},[p(N,null,{default:f(()=>[D,L]),_:1})]),p(P(y),{headers:e.headers,search:e.searchQuery,items:e.displayedItems,"rows-per-page-items":e.itemsPerPage,"footer-props":e.footerProps,density:"default"},{item:f(({item:r,index:g})=>[l("tr",null,[(t(!0),s(h,null,T(e.headers,(u,n)=>(t(),s("td",{key:n},[g===0&&n!==e.headers.length-1?(t(),_(b,{key:0,modelValue:u.search,"onUpdate:modelValue":c=>u.search=c,outlined:"","hide-details":"",onKeydown:w(e.filterOnEnter,["enter"]),onBlur:e.filterOnBlur,ref_for:!0,ref:"searchFields",style:{width:"100%","background-color":"#ffffff",border:"1px solid #cccccc","border-radius":"5px"},class:q({focused:e.isFocused})},null,8,["modelValue","onUpdate:modelValue","onKeydown","onBlur","class"])):n!==e.headers.length-1?(t(),s(h,{key:1},[x(A(r[u.value]),1)],64)):(t(),s(h,{key:2},[g!==0&&n===e.headers.length-1?(t(),s("div",O,[m((t(),s("div",{class:"btn-pointer",onClick:c=>e.redirectToView(r.id),title:"Visualizar"},K,8,F)),[[a,void 0,void 0,{hover:!0}]]),m((t(),s("div",{class:"btn-pointer",onClick:c=>e.redirectToUpdate(r.id),title:"Editar"},J,8,j)),[[a,void 0,void 0,{hover:!0}]]),m((t(),s("div",{class:"btn-pointer",id:"exclusão",onClick:c=>e.toggleExclusion(r),title:"Excluir"},[r.excluido?(t(),s("img",X)):(t(),s("img",Y))],8,W)),[[a,void 0,void 0,{hover:!0}]])])):V("",!0)],64))]))),128))])]),_:1},8,["headers","search","items","rows-per-page-items","footer-props"])]))}}}),oe=Q(ee,[["__scopeId","data-v-5087447d"]]),pe={__name:"TableModelo",setup(o){return(e,i)=>(t(),_(oe))}};export{pe as default};
